/*
*    ------ BEGIN LICENSE ATTRIBUTION ------
*    
*    Portions of this file have been appropriated or derived from the following project(s) and therefore require attribution to the original licenses and authors.
*    
*    Release: https://github.com/singharti/08-07-19/releases/tag/master-8dcb0b8
*    Source File: options-updater.js
*    
*    Copyrights:
*      copyright © magento, inc. all rights reserved
*      copyright (c) 2010 "cowboy" ben alman
*      (c) 2010-%d justin hileman
*      (c),d=r(280),a=n(d),x=r(294),k=n(x),i=r(288),t=n(i),f=function(e){function t(){var e,r,n,o;(0,f.default)(this,t);for(var a=a
*      (c);r(735);var d=r(280),a=n(d),x=r(305),k=n(x),i=r(294),t=n(i),f={"./infotext.css":{inlinevalue:"infotext_inlinevalue_7d06",
*      (c),j=r(280),a=n(j),x=r(294),k=n(x),i=r(288),t=n(i),f=function(e){function t(){var e,r,n,o;(0,f.default)(this,t);for(var a=a
*      (c);r(735);var j=r(280),a=n(j),x=r(305),k=n(x),i=r(294),t=n(i),f={"./infotext.css":{inlinevalue:"infotext_inlinevalue_7d06",
*      (c),j=r(259),a=n(j);t.publicapi=i,t.accountcreatemarco=o,t.carrierconnectmarco=a,t.carrierconfiguremarco=u,t.completioncreat
*      (c),x=r(280),a=n(x),k=r(294),j=n(k),i=r(288),p=n(i),m=function(e){function t(){var e,r,n,o;(0,d.default)(this,t);for(var a=a
*      (c);r(735);var x=r(280),a=n(x),k=r(305),j=n(k),i=r(294),p=n(i),m={"./infotext.css":{inlinevalue:"infotext_inlinevalue_7d06",
*      (c),f=r(112),d=n(f),p=r(106),h=n(p),m=r(734),y=n(m),v="undefined"!==typeof window&&window.console,b=function(){},g=b,_=b;v&&
*      (c),f=r(106),d=n(f),p=r(107),h=r(331),m=n(h),y=r(278),v=n(y),b=r(283),g=r(719),_=n(g),w=r(347),o=n(w),e=r(344),s=n(e),c=r(46
*      (c),f=r(260),d=n(f),p=r(261),h=n(p),m=r(263),v=n(m),y=r(264),g=n(y),_=r(45),b=n(_),w=r(271),o=r(281),e=r(310),k=r(107),s=r(9
*      (c),f=r(261),d=n(f),p=r(263),h=n(p),m=r(264),v=n(m),y=r(272),g=n(y),_=r(259),b=n(_),w=r(45),o=n(w),e=r(454),k=r(455),s=n(k),
*      (c),f=r(261),d=n(f),p=r(263),h=n(p),m=r(264),y=n(m),v=r(272),b=n(v),g=r(259),_=n(g),w=r(45),o=n(w),e=r(454),s=r(455),c=n(s),
*      (c),f=r(263),d=n(f),p=r(264),h=n(p);t.default=o;var m=r(45),y=n(m),v=r(107),b=r(274),g=n(b),_=r(306),w=n(_),o=r(458),e=n(o);
*      (c),f=r(263),d=n(f),p=r(264),h=n(p);t.default=o;var m=r(45),y=n(m),v=r(107),g=r(274),b=n(g),_=r(306),o=n(_),w=r(458),e=n(w);
*      (c),f=r(263),d=n(f),p=r(264),h=n(p);t.default=o;var m=r(45),y=n(m),v=r(271),b=r(698),g=n(b),_=r(394),w=n(_);e.exports=t.defa
*      (c),f=r(108),d=n(f),p=r(277),h=n(p);t.default=s;var m=r(274),y=n(m),v=r(341),b=n(v),g=r(278),_=n(g);e.exports=t.default},,,,
*      (c),f=r(108),d=n(f),p=r(277),h=n(p);t.default=s;var m=r(274),y=n(m),v=r(341),b=n(v),g=r(278),_=n(g);e.exports=t.default},,,f
*      (c),f=r(280),d=n(f),p=r(468),h=n(p),m=r(305),y=n(m),v=r(451),g=n(v),b=r(676),_=n(b),o=function(e){var t=e.handlesubmit,r=e.i
*      (c),f=r(290),d=n(f),p=r(815),h=n(p);e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esmodule?e
*      (c),f=r(265),d=n(f),p=r(825),h=n(p),m=function(e,t){var r=e.icon,n=e.onclick,a=t.intl;return s.default.createelement("button
*      (c),f=r(265),d=n(f),p=r(825),h=n(p),m=function(e,t){var r=e.icon,n=e.onclick,o=t.intl;return s.default.createelement("button
*      (c),f=r(259),d=n(f);t.default=a;var p=r(274),h=n(p),m=r(815),v=n(m);e.exports=t.default},function(e,t,r){"use strict";functi
*      (c),f=r(284),d=object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)object.proto
*      (c),f=r(271),d=r(281),p=r(577),h=r(258),m=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.e
*      (c),d=r(112),f=n(d),p=r(106),h=n(p),m=r(734),v=n(m),y="undefined"!==typeof window&&window.console,g=function(){},b=g,_=g;y&&
*      (c),d=r(106),f=n(d),p=r(107),h=r(331),m=n(h),v=r(278),y=n(v),g=r(283),b=r(719),_=n(b),w=r(347),o=n(w),e=r(344),s=n(e),c=r(46
*      (c),d=r(261),f=n(d),p=r(263),h=n(p),m=r(264),v=n(m),y=r(272),g=n(y),b=r(259),_=n(b),w=r(45),o=n(w),e=r(454),s=r(455),c=n(s),
*      (c),d=r(261),f=n(d),p=r(263),h=n(p),m=r(264),v=n(m),y=r(45),g=n(y),b=r(338),_=n(b),w=r(869),o=n(w),e=r(871),s=n(e),c=r(874),
*      (c),d=r(261),f=n(d),p=r(263),m=n(p),h=r(264),g=n(h),b=r(272),v=n(b),y=r(259),e=n(y),_=r(45),w=n(_),a=r(454),c=r(455),d=n(c),
*      (c),d=r(263),f=n(d),p=r(264),h=n(p);t.default=o;var m=r(45),v=n(m),y=r(107),g=r(274),b=n(g),_=r(306),w=n(_),o=r(458),e=n(o);
*      (c),d=r(263),f=n(d),p=r(264),h=n(p);t.default=o;var m=r(45),v=n(m),y=r(271),g=r(698),b=n(g),_=r(394),w=n(_);e.exports=t.defa
*      (c),d=r(108),f=n(d),p=r(277),h=n(p);t.default=s;var m=r(274),v=n(m),y=r(341),g=n(y),b=r(278),_=n(b);e.exports=t.default},fun
*      (c),d=r(284),f=object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)object.proto
*      (c),d=r(271),f=r(281),p=r(577),h=r(258),m=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.e
*      (c),f=r(562),p=r(284),h=object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)obj
*      (c),f=r(490),d=r(377),p=r(284),h=r(258),m=object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];
*      (c),f=r(559),d=r(377),p=r(258),h=r(284),m=object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];
*      (c),f=n(125),h=r(f),p=n(109),m=r(p),y=n(763),v=r(y),_=n(262),g=r(_),b=n(260),w=r(b),o=n(261),k=r(o),s=n(263),m=r(s),p=n(264)
*      (c),f=n(108),h=r(f),p=n(259),m=r(p),y=n(260),v=r(y),_=n(261),g=r(_),b=n(428),w=r(b),k=n(431),o=r(k),s=n(432),m=r(s),c=functi
*      (c),f=n(108),h=r(f),p=n(259),m=r(p),y=n(260),v=r(y),_=n(261),g=r(_),b=n(428),w=r(b),o=n(431),k=r(o),s=n(432),m=r(s),p=functi
*      (c),f=n(260),h=r(f),p=n(261),m=r(p),y=n(263),v=r(y),_=n(264),g=r(_),b=n(45),w=r(b),k=n(265),o=r(k),s=n(777),m=r(s),c=functio
*      (c),f=n(260),h=r(f),p=n(261),m=r(p),y=n(263),v=r(y),_=n(264),g=r(_),b=n(45),w=r(b),o=n(265),k=r(o),s=n(777),m=r(s),p=functio
*      (c),f=n(261),h=r(f),p=n(263),m=r(p),y=n(264),v=r(y),_=n(45),g=r(_),b=n(768),w=r(b),k=n(305),o=r(k),s=function(e){function t(
*      (c),f=n(261),h=r(f),p=n(263),m=r(p),y=n(264),v=r(y),_=n(45),g=r(_),b=n(768),w=r(b),o=n(305),k=r(o),s=function(e){function t(
*      (c),f=n(109),h=r(f),p=n(343),m=r(p),y=n(262),v=r(y),_=n(260),g=r(_),b=n(261),w=r(b),k=n(263),o=r(k),s=n(264),m=r(s),c=n(45),
*      (c),f=n(264),h=r(f),p=n(45),m=r(p),y=n(265),v=r(y),_=n(287),g=r(_),b=function(e){function t(e){(0,s.default)(this,t);var n=(
*      (c),f=n(264),h=r(f),p=n(45),m=r(p),y=n(265),v=r(y),_=n(287),g=r(_),b=function(e){function t(e){(0,u.default)(this,t);var n=(
*      (c),f=n(264),h=r(f),p=n(45),m=r(p),y=n(265),v=r(y),_=n(341),g=r(_),b=n(287),w=r(b),k=function(e){function t(e){(0,s.default)
*      (c),f=n(264),h=r(f),p=n(45),m=r(p),y=n(265),v=r(y),_=n(341),g=r(_),b=n(287),w=r(b),o=function(e){function t(e){(0,u.default)
*      (c),f=n(264),h=r(f),p=n(45),m=r(p),y=n(290),v=r(y),_=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(thi
*      (c),f=n(264),h=r(f),p=n(45),m=r(p),y=n(290),v=r(y),_=function(e){function t(e){(0,u.default)(this,t);var n=(0,d.default)(thi
*      (c),x=r(267),k=n(x),a=r(259),j=n(a);t.publicapi=o,t.accountcreatemarco=a,t.carrierconnectmarco=i,t.carrierconfiguremarco=u,t
*      (c),x=r(267),k=n(x),o=r(259),q=n(o);t.publicapi=a,t.accountcreatemarco=o,t.carrierconnectmarco=u,t.carrierconfiguremarco=l,t
*      (c),f=r(717),p=n(f),h=r(106),m=n(h),v=t.linkify=new d.default;v.tlds(p.default);var y=function(e){function t(){var e,r,n,i;o
*      (c),f=r(106),p=n(f),h=r(107),m=r(265),v=n(m),y=r(738),g=n(y),b=r(274),_=n(b);r(746);var e=r(282),w=n(e),o=r(747),c=n(o),s=fu
*      (c),f=r(265),p=n(f),h=r(107),m=r(390),v=n(m),y=r(452),g=n(y),b=r(678),_=n(b),e=function(e){var t,r=e.children,n=e.title,o=e.
*      (c),f=r(108),p=n(f),h=r(259),m=n(h),v=r(260),y=n(v),g=r(261),b=n(g),_=r(428),e=n(_),w=r(431),o=n(w),c=r(432),s=n(c),x=functi
*      (c),f=r(262),p=n(f),h=r(260),m=n(h),v=r(261),y=n(v),g=r(263),b=n(g),_=r(264),e=n(_),w=r(45),o=n(w),c=r(106),s=n(c),x=r(107),
*      (c),f=r(261),p=n(f),h=r(263),m=n(h),v=r(264),y=n(v),g=r(45),b=n(g),_=r(106),e=n(_),w=r(107),o=r(282),c=n(o),s=r(664),x=n(s),
*      (c),f=r(261),p=n(f),h=r(263),m=n(h),v=r(264),y=n(v),g=r(45),b=n(g),_=r(106),e=n(_),w=r(107),o=r(282),c=n(o),s=r(750),x=n(s),
*      (c),f=r(261),p=n(f),h=r(263),m=n(h),v=r(264),y=n(v),g=r(45),b=n(g),_=r(106),e=n(_),w=r(265),o=n(w),c=r(393),s=n(c),x=r(311),
*      (c),f=r(261),p=n(f),h=r(263),m=n(h),v=r(264),y=n(v),g=r(45),b=n(g),_=r(107),e=r(339),w=n(e),o=r(342),c=r(457),s=n(c),x=r(100
*      (c),f=r(263),p=n(f),h=r(264),m=n(h),v=r(45),y=n(v),g=r(106),b=n(g),_=r(265),e=n(_),w=r(818),o=n(w),c=function(e){function t(
*      (c),f=r(263),p=n(f),h=r(264),m=n(h),v=r(45),y=n(v),g=r(107),b=r(311),_=n(b),e=r(755),w=n(e),o=r(280),c=n(o),s=r(898),x=n(s),
*      (c),f=r(263),p=n(f),h=r(264),m=n(h),v=r(45),y=n(v),g=r(112),b=n(g),_=r(280),e=n(_),w=b.default.unstable_rendersubtreeintocon
*      (c),f=r(263),p=n(f),h=r(264),m=n(h),v=r(45),y=n(v),g=r(265),b=n(g),_=r(658),e=n(_),w=function(e){function t(e){(0,l.default)
*      (c),f=r(263),p=n(f),h=r(264),m=n(h),v=r(45),y=n(v),g=r(281),b=r(271),_=r(697),e=n(_),w=r(434),o=function(e){function t(e){(0
*      (c),f=r(259),p=n(f),h=r(277),m=n(h),v=r(262),y=n(v),g=r(260),b=n(g),_=r(261),e=n(_),w=r(263),o=n(w),c=r(264),s=n(c),x=r(45),
*      (c),f=r(265),p=n(f),h=r(290),m=n(h),v=r(675),y=n(v),g=function(e){var t=e.domid,r=e.controlid,n=e.isrequired,o=e.onchange,i=
*      (c);t.getrequestoptions=o,t.default=a;var f=r(278),p=n(f),h=r(340),m=n(h),v=r(288),y=n(v),g=r(671),b=n(g)},function(e,t,r){\
*      (c),f=r(265),p=n(f),h=r(393),m=n(h),v=r(666),y=n(v),g=r(311),b=n(g),_=r(669),e=n(_),w=function(e){var t,r=e.domid,n=e.contro
*      (c),f=r(264),p=n(f),h=r(45),m=n(h),v=r(265),y=n(v),g=r(107),b=r(310),_=r(280),e=n(_),w=r(445),o=n(w),c=r(468),s=n(c),x=r(305
*      (c),f=r(264),p=n(f),h=r(45),m=n(h),v=r(265),y=n(v),g=r(287),b=n(g),_=function(e){function t(e){(0,u.default)(this,t);var r=(
*      (c),f=r(264),p=n(f),h=r(45),m=n(h),v=r(290),y=n(v),g=function(e){function t(e){(0,u.default)(this,t);var r=(0,d.default)(thi
*      (c),f=r(264),p=n(f),h=r(45),m=n(h),v=r(655),y=n(v),g=r(306),b=n(g),_=r(656),e=n(_),w=function(e){function t(e){(0,u.default)
*      (c),f=r(264),p=n(f),h=r(731),m=n(h),v=r(45),y=n(v),g=r(106),b=n(g),_=r(107),e=r(732),w=n(e),o=r(311),c=n(o),s=r(449),x=n(s);
*      (c),f=r(106),p=n(f),h=r(770),m=n(h),v=[{path:"/provider",operator:"equal",value:"*"}],y=function(e,t){var r=t.intl;return d.
*      (c),f=r(265),p=n(f),h=r(790),m=n(h),v=r(688),y=n(v),g=function(e){var t=e.children,r=e.columns,n=e.tightfit,o=e.classname,i=
*      (c),f=r(271),p=r(284),h=object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)obj
*      (c),f=r(107),p=r(310),h=r(781),m=n(h),v=r(280),y=n(v),g=r(823),b=n(g),_=r(755),e=n(_),w=r(892),o=n(w),c=r(779),s=n(c),x=r(76
*      (c),f=r(110),p=r.n(f),h=r(330),m=r.n(h),v=r(106),y=r.n(v),g=r(45),b=(r.n(g),r(271)),_=r(281),e=r(358),w=r(639),o=r(359),c=r(
*      (c),f=r(110),p=r.n(f),h=r(45),m=(r.n(h),r(471)),v=r(348),y=object.assign||function(e){for(var t=1;t<arguments.length;t++){va
*      (c),f.lastindex=0,f.test((0,l.default)(c))||u(),c}object.defineproperty(t,"__esmodule",{value:!0});var u=r(259),s=n(u),c=r(3
*      (c),x=r(259),t=n(x);t.publicapi=o,t.accountcreatemarco=a,t.carrierconnectmarco=i,t.carrierconfiguremarco=u,t.completioncreat
*      (c)&&object(u.a)(f,c)&&(object(i.a)(e)||object(a.a)(e))}var o=r(384),a=r(320),i=r(269),u=r(323),s=r(325),l=r(286);t.a=n},fun
*      (c),e=n(259),x=r(e);t.publicapi=o,t.accountcreatemarco=i,t.carrierconnectmarco=a,t.carrierconfiguremarco=s,t.completioncreat
*      (c),f=n(1210),h=i(f),d=function(){function e(t,n){o(this,e),this.loadannotation(t),this.inline=this.startwith(this.annotatio
*      (c)?"; secure":"")},remove:function(e,b){var c=new date();c.settime(c.gettime()-1000);this.set(e,"",c,b,c)}})})();(function(
*      (c),c},e.prototype._setdisposable=function(t){this._bitfield=131072|this._bitfield,this._disposer=t},e.prototype._isdisposab
*      (c),f=n(6),h=r(f),d=n(5),m=r(d),v=n(0),g=r(v),y=n(1072),_=r(y),b=n(12),x=r(b),w=n(1),k=r(w),e=function(e){function t(){var e
*      (c),f=r(1052),d=n(f),p=function(e){return a.default.createelement(i.provider,{store:s.default},a.default.createelement("div"
*      (c),f=r(781),p=n(f),h=r(1027),m=n(h),v=r(280),y=n(v),g=r(468),b=n(g),_=r(305),e=n(_),w=r(451),o=n(w),c=r(779),s=n(c),x=r(676
*      (c),f=r(1019),p=n(f),h=r(1020),m=n(h),v=r(1022),y=n(v),g=r(1023),b=n(g),_=function(e){var t=e.autofill,r=e.defaultdimensions
*      copyright (c) 2012: scott jehl, paul irish, nicholas zakas, david knight. dual mit/bsd license
*      copyright (c) 2012: scott jehl. dual mit/bsd license
*      (c);va(a,b,d,c,e,f);var m=c.$$hasnativevalidators&&"range"===b[0].type,p=m?0:void 0,n=m?100:void 0,r=m?1:void 0,q=b[0].valid
*      (c),e]):t.remove(s));m(b,a,c,e);d.$$phase||d.$apply()}function m(a,c,d,e){c=math.max(c,0);(200<=c&&300>c?p.resolve:p.reject)
*      (c);128>e.bitlength(c)&&(h=g(h,d(h)),c=e.concat(c,[-2147483648,0,0,0]));f=g(f,c)
*      copyright (c) 2008 adam royle
*      copyright 2016 amazon.com, inc. or its affiliates. all rights reserved
*      copyright (c) 2007 andrew tetlaw
*      copyright (c) 2012 anthony ferrara
*      copyright (c) 2017 arne blankerts <arne@blankerts.de> and contributors
*      copyright (c) 2016 arne blankerts <arne@blankerts.de>, sebastian heuer <sebastian@phpeople.de>, sebastian bergmann <sebastia
*      copyright 2014 arroba it
*      copyright 2012, authors.txt (http://jqueryui.com/about)
*      copyright (c) 2013 ben ramsey <http://benramsey.com>
*      copyright (c) 2014 bernhard schussek
*      (c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");e=e||64;var f=sjcl.mode.ocb2.s,h=sjcl.bitarray,l=h.i,k=[0,0,
*      (c))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var f,h=sjcl.mode.ocb2.s,l=sjcl.bitarray,k=l.i,m=[0,0,0,0];c
*      copyright (c) 2017 braintree, a division of paypal, inc
*      copyright 12th may 2003, by stephen chapman, felgall pty ltd
*      copyright (c) 2008 caius durling
*      copyright (c) 2013, colin mollenhour
*      copyright  copyright (c) 2013 colin mollenhour (http://colin.mollenhour.com)
*      copyright (c) 2011 colin mollenhour <colin@mollenhour.com>
*      (c)?c:9===ca?"":null;a.prop("value",e);d.$set("value",c)}return{restrict:"a",priority:100,compile:function(b,d){return fh.te
*      copyright (c) 2017 composer
*      copyright (c) 2010 conrad irwin <conrad@rapportive.com> mit license
*      (c) 2013 david desberg <david@daviddesberg.com>
*      copyright (c) 2016 dotdigital group plc
*      copyright(c) 2015 douglas christopher wilson
*      copyright (c) 2012 dragonfly development inc
*      copyright (c) 2016 epfremmer
*      copyright (c) 2013, evan coury
*      copyright 2004-present facebook
*      copyright 2011 facebook, inc
*      copyright 2004-present facebook. all rights reserved
*      copyright (c) 2008 fiona burrows
*      copyright (c) 2011 françois zaninotto
*      copyright (c) 2007 free software foundation, inc. <http://fsf.org/> everyone is permitted to copy and distribute verbatim co
*      copyright (c) 2012, george argyros
*      copyright (c) 2016 gias kay lee | mit license */!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["a
*      copyright (c) 2013 gias kay lee | mit license */"use strict";!function(){function a(a){return["$rootscope","$window",functio
*      © 2014 greg bergé | license mit
*      copyright(c) 2015 gregory jacobs <greg@greg-jacobs.com>
*      copyright (c) 2010 ivan bozhanov (vakata.com)
*      copyright (c) 2010 ivan bozhanov (vakata.com)\n *\n * licensed same as jquery - under the terms of either the mit license or
*      © 2015 ivan malopinsky - http://imsky.co
*      (c)._ticks(a.utils.calcticksx(d/100,j)).ticksize(-h,0),l.select(".nv-x.nv-axis").attr("transform","translate(0,"+d.range()[0
*      copyright (c) 2016 jed watson
*      copyright 2009 jim wigginton
*      (c) 2013 joachim wester
*      copyright (c) 2018 johannes m. schmitt
*      copyright 2012 johannes m. schmitt <schmittjoh@gmail.com>
*      copyright 2010, john resig
*      copyright (c) 2006 john resig, yehuda katz, jï¿½ã¶rn zaefferer, paul mclanahan
*      copyright 2013 jquery foundation and other contributors
*      copyright 2014 jquery foundation and other contributors; licensed mit
*      copyright 2014 jquery foundation and other contributors; licensed mit */\n\n(function( $, undefined ) {\n\nvar uuid = 0,\n\t
*      copyright 2017 juliette reinders folmer. all rights reserved
*      copyright (c) 2009 justin poliey <jdp34@njit.edu>
*      copyright (c) 2012 jörn zaefferer
*      (c).ticks(a.utils.calcticksx(t/100,k)).ticksize(-u,0),z.select(".nv-x.nv-axis").attr("transform","translate(0,"+d.range()[0]
*      copyright 2011, klaus hartl
*      copyright (c) 2005 lawrence rosen. permission is granted to copy, distribute, or communicate this license without modificati
*      copyright © 2005 lawrence rosen. permission is granted to copy, distribute, or communicate this license without modification
*      copyright © 2016 magento. all rights reserved
*      copyright (c) 2017 matthew grasmick
*      copyright (c) 2015, matthias mullie <pdepend@mullie.eu>
*      copyright 2015 matthias mullie. all rights reserved
*      copyright (c) 2011 michael bodnarchuk and contributors
*      copyright 2014 michael cummings
*      copyright (c) 2010 mike van riel
*      copyright (c) 2008 mkmanning mit license
*      copyright 2009, moxiecode systems ab
*      copyright (c) 2013 my c-sense
*      copyright treaty adopted on 20 december 1996, or similar laws prohibiting or restricting circumvention of such measures
*      copyright (c) 2007, parakey inc
*      copyright (c) 2014 phil bennett <philipobenito@gmail.com>
*      copyright (c) 2012 php framework interoperability group
*      copyright (c) 2015 phpdocumentor
*      (c) 2013 pieter hordijk <info@pieterhordijk.com>
*      copyright (c) 2014 ralph khattar
*      copyright  2002 richard clamp <richardc@unixbeard.net>
*      (c) 2014 rob wu <rob@robwu.nl>
*      copyright 2011 robert dallas gray. all rights reserved
*      copyright (c) 2009, robert hafner
*      copyright 2013 scott jehl
*      copyright 2012, sebastian tschan
*      copyright 2017 smartbear software
*      copyright (c) 2006 sébastien gruhier (http://xilinus.com, http://itseb.com)
*      copyright © 2018 temando pty ltd. all rights reserved
*      copyright 2012 the authors
*      copyright 2009, the dojo foundation
*      copyright (c) 2014 the polymer project authors. all rights reserved
*      copyright treaty of 1996, the wipo performances and phonograms
*      copyright treaty of 1996, the wipo performances and phonograms treaty of 1996 and the universal copyright convention (as rev
*      copyright year from 2017 to 2018. (by @bhargavmehta)
*      copyright (c) 2013 trent richardson; licensed mit
*      copyright (c) 2014 trueserver b.v
*      copyright  copyright (c) 2017 turiknox
*      copyright (c) 2013, vance lucas
*      copyright (c) 2013 yahoo! inc. all rights reserved
*      copyright (c) 2010, yahoo! inc. all rights reserved. code licensed under the bsd license: http://developer.yahoo.com/yui/lic
*      copyright 2014 yandex llc
*      copyright  1997~1994 the php group
*      (c)}else l._resolvecallback(f);return l},e.prototype._setboundto=function(e){void 0!==e?(this._bitfield=2097152|this._bitfie
*      copyright  1994-1997 the php group
*      copyright (c) 1991, 1999 free software foundation, inc
*      copyright (c) 2001, 2002 by
*      copyright  2004-2005 fabien potencier <fabien@symfony.com>
*      copyright(c) 2006-2007, ext js, llc
*      copyright (c) 2005-2008 thomas fuchs (http://script.aculo.us, http://mir.aculo.us)
*      copyright (c) 2006-2009 hampton catlin, nathan weizenbaum, and chris eppstein
*      copyright (c) 2006-2009 mika tuupola, dylan verheul
*      (c) 2005-2010 sam stephenson
*      copyright (c) 2007-2011, manuel pichler <mapi@phpundercontrol.org>
*      copyright  copyright (c) 2009 - 2011, realdolmen (http://www.realdolmen.com)
*      copyright  (c)  wch  2002-2013
*      copyright (c) 2014 doctrine project
*      copyright 2005, 2013 jquery foundation, inc. and other contributors; licensed mit
*      copyright (c) 2013 konstantin kudryashov <ever.zet@gmail.com>
*      copyright 2010-2014 alexander obuhovich
*      copyright 2010-2014 andy grunwald
*      copyright 2012-2014 christian weiske
*      copyright 2009-2014 florian grandel
*      copyright 2010, 2014 jquery foundation, inc. and other contributors
*      copyright 2007-2014 mayflower gmbh
*      copyright 2010-2014 mediaself sp. z o.o
*      copyright 2013-2014 roman levishchenko
*      copyright(c) 2012-2014 roman shtylman
*      copyright 2010-2014 stefano kowalke
*      copyright (c) 2010-2014, the dojo foundation all rights reserved
*      copyright (c) 2009-2015, alexis sellier <self@cloudhead.net>
*      copyright (c) 2012-2015 dan wheeler and dropbox, inc
*      (c) 2009-2015 jeremy ashkenas, documentcloud and investigative reporters & editors
*      copyright (c) 2014-2015, jon schlinkert
*      copyright 2010-2015 mike van riel / naenius (http://www.naenius.com)
*      copyright (c) 2013-2015 petka antonov
*      copyright (c) 2013-2015 viacheslav lotsmanov
*      copyright (c) 2013 container-interop
*      copyright (c) 2011-2016 jordi boggiano
*      copyright 2013-2016 moontoast, inc
*      copyright 2007-2016 terrafrost and other contributors
*      copyright 2011-2014 twitter, inc
*      copyright (c) 2010-2017 arne blankerts <arne@blankerts.de>
*      copyright (c) 2016-2017 arne blankerts <arne@blankerts.de>, sebastian heuer <sebastian@phpeople.de> and contributors
*      copyright (c) 2010-2015 justin hileman
*      copyright © 2013-2017 magento, inc. all rights reserved
*      copyright (c) 2008-2013, manuel pichler <mapi@pdepend.org>
*      copyright (c) 2008-2017, manuel pichler <mapi@phpmd.org>
*      copyright 2007-2011 manuel pichler. all rights reserved
*      copyright 2010-2015 mike van riel<mike@phpdoc.org>
*      copyright (c) 2001-2017, sebastian bergmann <sebastian@phpunit.de>
*      copyright 2006-2015 squiz pty ltd (abn 77 084 670 600)
*      copyright (c) 2012-2018 ben ramsey <ben@benramsey.com>
*      copyright (c) 2017-2018 consolidation developers
*      copyright 2013-2018 david deutsch
*      (c) 2010-2018 google, inc. http://angularjs.org
*      copyright (c) 2015 michael dowling, https://github.com/mtdowling <mtdowling@gmail.com>
*      copyright (c) 2015 paragon initiative enterprises
*      copyright (c) 2008-2018 pelago
*      copyright copyright (c) 2018 zend technologies usa inc. (https://www.zend.com)
*      copyright (c) 2005-2015, zend technologies usa, inc
*      copyright (c) 2014 codegyre developers team, consolidation team
*      copyright (c) 2016-2018 consolidation org developers
*      copyright (c) 2012-2018 fabien potencier
*      copyright (c) 2005-2015 zend technologies usa inc. (http://www.zend.com)
*    
*    Licenses:
*      Open Software License 3.0
*      SPDXId: OSL-3.0
*    
*      Academic Free License v3.0
*      SPDXId: AFL-3.0
*    
*    Auto-attribution by Threatrix, Inc.
*    
*    ------ END LICENSE ATTRIBUTION ------
*/
define([
    'jquery',
    'underscore',
    'Magento_Customer/js/customer-data'
], function ($, _, customerData) {
    'use strict';

    var selectors = {
        formSelector: '#product_addtocart_form',
        productIdSelector: '#product_addtocart_form [name="product"]',
        itemIdSelector: '#product_addtocart_form [name="item"]'
    },
    cartData = customerData.get('cart'),
    productId = $(selectors.productIdSelector).val(),
    itemId = $(selectors.itemIdSelector).val(),

    /**
    * set productOptions according to cart data from customer-data
    *
    * @param {Object} data - cart data from customer-data
    * @returns {Boolean} - whether the new options differ from previous
    */
    setProductOptions = function (data) {
        var changedProductOptions;

        if (!(data && data.items && data.items.length && productId)) {
            return false;
        }
        changedProductOptions = _.find(data.items, function (item) {
            if (item['item_id'] === itemId) {
                return item['product_id'] === productId;
            }
        });
        changedProductOptions = changedProductOptions && changedProductOptions.options &&
            changedProductOptions.options.reduce(function (obj, val) {
                obj[val['option_id']] = val['option_value'];

                return obj;
            }, {});

        if (JSON.stringify(this.productOptions || {}) === JSON.stringify(changedProductOptions || {})) {
            return false;
        }

        this.productOptions = changedProductOptions;

        return true;
    },

    /**
    * Listens to update of cart data or options initialization and update selected option according to customer data
    *
    */
    listen = function () {
        cartData.subscribe(function (updateCartData) {
            if (this.setProductOptions(updateCartData)) {
                this.updateOptions();
            }
        }.bind(this));
        $(selectors.formSelector).on(this.eventName, function () {
            this.setProductOptions(cartData());
            this.updateOptions();
        }.bind(this));
        this.updateOptions();
    },

    /**
    * Updater constructor function
    *
    */
    Updater = function (eventName, updateOptionsCallback) {
        if (this instanceof Updater) {
            this.eventName = eventName;
            this.updateOptions = updateOptionsCallback;
            this.productOptions = {};
        }
    };

    Updater.prototype.setProductOptions = setProductOptions;
    Updater.prototype.listen = listen;

    return Updater;
});
